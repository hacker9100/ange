define(["controller/controllers"],function(controllers){controllers.controller("dashboard_main",["$scope","$rootScope","$location","dialogs","COMMON",function($scope,$rootScope,$location,dialogs,COMMON){$scope.init=function(){$scope.oneAtATime=true;$scope.PAGE_NO=0;$scope.PAGE_SIZE=COMMON.DASHBOARD_PAGE_SIZE};$scope.click_showTaskList=function(){$location.url("/task/list")};$scope.click_showTaskView=function(key){$location.url("/task/view/"+key)};$scope.click_showViewContent=function(item){var list="edit";if(item.PHASE=="10"||item.PHASE=="11")list="article";else if(item.PHASE=="20"||item.PHASE=="21")list="edit";$location.url("/"+list+"/view/"+item.NO)};$scope.click_showGetHistory=function(key){$scope.openModal({TASK_NO:key},"lg")};$scope.openModal=function(item,size){var dlg=dialogs.create("/partials/cms/history.html",function($scope,$controller,$modalInstance,data){angular.extend(this,$controller("cms_common",{$scope:$scope}));$scope.getList("cms/history","list",{},item,true).then(function(data){$scope.list=data})["catch"](function(error){console.log(error)});$scope.list=data;$scope.click_ok=function(){$modalInstance.close()}},item,{size:size,keyboard:true});dlg.result.then(function(){},function(){})};$scope.getTaskList=function(){var search={};if($rootScope.role!="CMS_ADMIN"&&$rootScope.role!="MANAGER")search={EDITOR_ID:$rootScope.uid};$scope.isLoading=true;$scope.getList("cms/task","list",{NO:$scope.PAGE_NO,SIZE:$scope.PAGE_SIZE},search,true).then(function(data){$scope.list=data})["catch"](function(error){$scope.list=[];console.log(error)})["finally"](function(){$scope.isLoading=false})};$scope.setTitle=function(session){$scope.$parent.$parent.pageDescription=$rootScope.name+" \ub2d8\uc758 \ub300\uc2dc\ubcf4\ub4dc\uc785\ub2c8\ub2e4."};$scope.getSession().then($scope.sessionCheck).then($scope.permissionCheck).then($scope.setTitle)["catch"]($scope.reportProblems);$scope.init();$scope.getTaskList()}])});