define(["controller/controllers"],function(d){d.controller("publish-edit",["$scope","$stateParams","$modal","$location","ngTableParams",function(a,n,d,m,h){a.openModal=function(c,b,g){d.open({templateUrl:"publish_modal.html",controller:"publish_modal",size:g,resolve:{content:function(){return c},status:function(){return b}}}).result.then(function(b){alert(JSON.stringify(b));b.DELETE_FL="1";a.tasks.push(b)},function(){$log.info("Modal dismissed at: "+new Date)})};var e={};a.init=function(){e={PROJECT:{NO:n.id}};
    m.search("_search",e)};a.createEPUB=function(){};a.getTaskList=function(){a.tableParams=new h({page:1,count:1E3,sorting:{SECTION_NO:"asc"}},{groupBy:"SECTION_NM",counts:[],total:0,getData:function(c,b){a.getList("cms/task","list",{},a.search,!0).then(function(a){b.total(a[0].TOTAL_COUNT);c.resolve(a)})["catch"](function(a){c.resolve([])})}})};var l=function(c,b){var g=a.tableParams.data[b];a.tableParams.data[b]=a.tableParams.data[c];a.tableParams.data[c]=g};a.moveUpSection=function(a){0!=a&&l(a,a-
    1)};a.moveDownSection=function(c){void 0!=a.tableParams.data[c+1]&&l(c,c+1)};var k=function(c,b,g){var e=a.tableParams.data[c].data[g];a.tableParams.data[c].data[g]=a.tableParams.data[c].data[b];a.tableParams.data[c].data[b]=e};a.moveUpTask=function(a,b){0!=b&&k(a,b,b-1)};a.moveDownTask=function(c,b){void 0!=a.tableParams.data[c].data[b+1]&&k(c,b,b+1)};a.deleteItem=function(c){a.tasks.splice(c,1);alert(JSON.stringify(a.tasks))};a.addItem=function(){a.tasks.push({PROJECT_NO:"18",PROJECT_NM:"\uac1c\ubc1c\uc11c\ubc84 \uc774\ubbf8\uc9c0 \uc218\uc815",
    NO:"ADD",SUBJECT:"\uc774\ubbf8\uc9c0",DELETE_FL:"1"})};a.addItem=function(){a.openModal(null,null,"lg")};a.getSession().then(a.sessionCheck).then(a.permissionCheck)["catch"](a.reportProblems);a.getTaskList()}]);d.controller("publish_modal",["$scope","$modalInstance","content","status","$location",function(a,d,p,m,h){a.search=[];a.CATEGORY=[];var e=[{NO:0,CATEGORY_B:"001",CATEGORY_M:"",CATEGORY_S:"",DEPTH:"1",CATEGORY_NM:"\uc784\uc2e0\uc900\ube44",CATEGORY_GB:"1",CATEGORY_ST:"0"},{NO:1,CATEGORY_B:"002",
    CATEGORY_M:"",CATEGORY_S:"",DEPTH:"1",CATEGORY_NM:"\uc784\uc2e0\ucd08\uae30",CATEGORY_GB:"1",CATEGORY_ST:"0"},{NO:2,CATEGORY_B:"003",CATEGORY_M:"",CATEGORY_S:"",DEPTH:"1",CATEGORY_NM:"\uc784\uc2e0\uc911\uae30",CATEGORY_GB:"1",CATEGORY_ST:"0"},{NO:3,CATEGORY_B:"001",CATEGORY_M:"",CATEGORY_S:"",DEPTH:"1",CATEGORY_NM:"\uac74\uac15",CATEGORY_GB:"2",CATEGORY_ST:"0"},{NO:4,CATEGORY_B:"002",CATEGORY_M:"",CATEGORY_S:"",DEPTH:"1",CATEGORY_NM:"\uc74c\uc2dd",CATEGORY_GB:"2",CATEGORY_ST:"0"},{NO:5,CATEGORY_B:"003",
    CATEGORY_M:"",CATEGORY_S:"",DEPTH:"1",CATEGORY_NM:"\ub180\uc774",CATEGORY_GB:"2",CATEGORY_ST:"0"},{NO:6,CATEGORY_B:"001",CATEGORY_M:"001",CATEGORY_S:"",DEPTH:"2",CATEGORY_NM:"\uac80\uc0ac",CATEGORY_GB:"2",CATEGORY_ST:"0"},{NO:7,CATEGORY_B:"001",CATEGORY_M:"002",CATEGORY_S:"",DEPTH:"2",CATEGORY_NM:"\uc6b4\ub3d9",CATEGORY_GB:"2",CATEGORY_ST:"0"}];a.$watch("CATEGORY_M",function(b){var c=[];if(void 0!=b){for(var d in e){var f=e[d];f.CATEGORY_B==b.CATEGORY_B&&"2"==f.CATEGORY_GB&&""!=f.CATEGORY_M&&c.push(f)}a.category_s=
    c}});a.removeCategory=function(b){a.CATEGORY.splice(b,1)};var l=[],k=(new Date).getFullYear(),c=[];a.initList=function(){a.oneAtATime=!0;for(var b=k-5;b<k+5;b++)l.push(b+"");projectService.getProjectOptions().then(function(b){c=b.data;a.projects=b.data;null!=a.projects&&(a.search.PROJECT=a.projects[0])});a.select_settings={externalIdProp:"",idProp:"NO",displayProp:"CATEGORY_NM",dynamicTitle:!1,showCheckAll:!1,showUncheckAll:!1};if(null!=e){var g=[],d=[];for(b in e){var f=e[b];"1"==f.CATEGORY_GB?g.push(f):
    "2"==f.CATEGORY_GB&&""==f.CATEGORY_M&&d.push(f)}a.category_a=g;a.category_b=d}b=[{name:"\uae30\uc790",value:"EDITOR_NM"},{name:"\uc81c\ubaa9+\ub0b4\uc6a9",value:"SUBJECT"}];a.years=l;a.projects=c;a.order=b;a.search.YEAR=k+"";a.search.PROJECT=c[0];a.search.ORDER=b[0]};a.createNewTask=function(){h.path("/task/0")};a.editTask=function(a){h.path("/task/"+a)};a.showHistory=function(a){alert("\uc900\ube44\uc911\uc785\ub2c8\ub2e4.")};a.deleteTask=function(b){b=a.tasks[b];"30"==b.PHASE?alert("\uc644\ub8cc \uc0c1\ud0dc\uc758 \ud0dc\uc2a4\ud06c\ub294 \uc0ad\uc81c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."):
    taskService.deleteTask(b.NO).then(function(b){a.getListTasks()})};a.searchTask=function(){a.search.CATEGORY=a.CATEGORY;h.search("_search",a.search);a.getTaskList()};a.getTaskList=function(){a.isLoading=!0;taskService.getTasks().then(function(b){a.tasks=b.data;a.isLoading=!1;h.search("_search",null)})};a.initList();a.getTaskList();a.selectTask=function(a){d.close(a)};a.ok=function(){};a.cancel=function(){d.dismiss("cancel")}}])});