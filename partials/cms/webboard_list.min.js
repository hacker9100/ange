define(["controller/controllers"],function(controllers){controllers.controller("webboard_list",["$scope","$rootScope","$stateParams","$location","dialogs","ngTableParams",function($scope,$rootScope,$stateParams,$location,dialogs,ngTableParams){$scope.search={SYSTEM_GB:"CMS"};$scope.init=function(){var condition=[{name:"\ub4f1\ub85d\uc790",value:"REG_NM"},{name:"\uc81c\ubaa9+\ub0b4\uc6a9",value:"SUBJECT"}];$scope.conditions=condition;$scope.search.CONDITION=condition[0]};$scope.click_showCreateNewCmsBoard=function(){$location.url("/webboard/edit/0")};$scope.click_showViewCmsBoard=function(key){$location.url("/webboard/view/"+key)};$scope.click_showEditCmsBoard=function(item){if($rootScope.role!="CMS_ADMIN"&&$rootScope.role!="MANAGER"&&$rootScope.uid!=item.REG_UID){dialogs.notify("\uc54c\ub9bc","\uc218\uc815 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",{size:"md"});return}$location.path("/webboard/edit/"+item.NO)};$scope.click_deleteCmsBoard=function(item){if($rootScope.role!="CMS_ADMIN"&&$rootScope.role!="MANAGER"&&$rootScope.uid!=item.REG_UID){dialogs.notify("\uc54c\ub9bc","\uc0ad\uc81c \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",{size:"md"});return}var dialog=dialogs.confirm("\uc54c\ub9bc","\uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c.",{size:"md"});dialog.result.then(function(btn){$scope.deleteItem("com/webboard","item",item.NO,false).then(function(){dialogs.notify("\uc54c\ub9bc","\uc815\uc0c1\uc801\uc73c\ub85c \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",{size:"md"});$scope.tableParams.reload()})["catch"](function(error){dialogs.error("\uc624\ub958",error+"",{size:"md"})})},function(btn){return})};$scope.click_searchCmsBoard=function(){$scope.tableParams.$params.page=1;$scope.tableParams.reload()};$scope.PAGE_SIZE=10;$scope.getCmsBoardList=function(){$scope.tableParams=new ngTableParams({page:1,count:$scope.PAGE_SIZE,sorting:{REG_DT:"desc"}},{counts:[],total:0,getData:function($defer,params){var key=Object.keys(params.sorting())[0];$scope.search["SORT"]=key;$scope.search["ORDER"]=params.sorting()[key];$scope.getList("com/webboard","list",{NO:params.page()-1,SIZE:$scope.PAGE_SIZE},$scope.search,true).then(function(data){var total_cnt=data[0].TOTAL_COUNT;$scope.TOTAL_COUNT=total_cnt;params.total(total_cnt);$defer.resolve(data)})["catch"](function(error){$scope.TOTAL_COUNT=0;$defer.resolve([])})}})};$scope.getSession().then($scope.sessionCheck).then($scope.init).then($scope.getCmsBoardList)["catch"]($scope.reportProblems)}])});