<div ng-controller="content-edit-popup">
    <div class="modal-header article_windowtitle" ng-show="isModal">
        콘텐츠 등록/수정
        <a ng-click="click_close()" style="float:right; cursor:pointer;">Close</a>
    </div>

    <div ng-class="{'modal-body' : isModal}">

    <!-- Contents Include -->
    <div class="col-md-12">

        <!-- Task list -->
        <accordion close-others="oneAtATime">
            <accordion-group is-open="status.open" ng-model="task">

                <div class="task_progress_wrap">
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '0', 'task_progress' : task.PHASE != '0'}">태스크등록</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '10', 'task_progress' : task.PHASE != '10'}">원고작성</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '11', 'task_progress' : task.PHASE != '11'}">원고승인</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '12', 'task_progress' : task.PHASE != '12'}">원고반려</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '13', 'task_progress' : task.PHASE != '13'}">원고승인완료</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '20', 'task_progress' : task.PHASE != '20'}">편집작성</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '21', 'task_progress' : task.PHASE != '21'}">편집승인</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '22', 'task_progress' : task.PHASE != '22'}">편집반려</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <!-- span class="label label-default task_progress" ng-class="{'label-danger' : task.PHASE == '23'}">편집승인완료</span -->
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '30', 'task_progress' : task.PHASE != '30'}">출판대기</span><span class="glyphicon glyphicon-chevron-right task_progress_arrow"></span>
                    <span class="label label-default" ng-class="{'label-danger' : task.PHASE == '31', 'task_progress' : task.PHASE != '31'}">완료</span>
                </div>
                <!-- Task Head -->
                <accordion-heading style="clear:both; background-color:#000; padding:0;">
                    <div class="row" style="height:100%;">
                        <div class="col-md-12" style="position:relative; padding:5px; margin:0;  cursor:pointer;">
                            <a data-toggle="collapse" style="color:#333">
                                <div class="panel-title" style="height:100%; font-size:0.68em; line-height:18px;">
                                    <div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 task-col-series" style="height:100%; text-align:center; ">
                                        <span style="font-size:1.16em;">{{ task.SERIES_NM }}</span><br />
                                        <span>[{{ task.PROJECT_NM }}]</span>
                                    </div>
                                    <div class="col-xs-8 col-sm-6 col-md-6 col-lg-5 task-col-title" style="height:100%; display:inline; word-break: break-all; word-wrap: break-word; padding:8px 0;font-size:1.4em;">
                                        {{ task.SUBJECT }}
                                    </div>
                                    <div class="col-lg-1 task-col-manager" style="height:100%; margin-top:8px; text-align:left;">
                                        {{ task.REG_NM }}
                                    </div>
                                    <div class="col-md-2 col-sm-3 col-lg-2 task-col-date" style="height:100%; text-align:center; vertical-align:middle;">
                                        <span style="color:#868686;">{{task.REG_DT}} 등록</span><br />
                                        <span style="color:#DE4612; font-weight:bold;">{{task.CLOSE_YMD}} 마감</span>
                                    </div>
                                    <div class="col-md-2 col-lg-2 task-col-step" style="height:100%;  word-break: break-all; word-wrap: break-word; padding:8px 0; text-align:center;">

                                        <span class="badge" ng-class="{'step1' : task.PHASE == '0', 'step2' : task.PHASE == '10', 'step3' : task.PHASE == '11', 'step4' : task.PHASE == '12', 'step5' : task.PHASE == '13', 'step6' : task.PHASE == '20', 'step7' : task.PHASE == '21', 'step8' : task.PHASE == '22', 'step9' : task.PHASE == '23', 'step10' : task.PHASE == '30', 'step0' : task.PHASE == '31'}">
                                        {{
                                        task.PHASE == '0' ? '태스크등록' :
                                        task.PHASE == '10' ? '원고작성' :
                                        task.PHASE == '11' ? '원고승인대기' :
                                        task.PHASE == '12' ? '원고반려' :
                                        task.PHASE == '13' ? '원고승인완료' :
                                        task.PHASE == '20' ? '편집작성' :
                                        task.PHASE == '21' ? '편집승인대기' :
                                        task.PHASE == '22' ? '편집반려' :
                                        task.PHASE == '23' ? '편집승인완료' :
                                        task.PHASE == '30' ? '출판대기' :
                                        '완료'
                                        }}
                                        </span>
                                    </div>
                                </div>

                                <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-up': status.open, 'glyphicon-chevron-down': !status.open}" style="position:absolute; top: 15px; right:10px;"></i>
                            </a>
                        </div>
                    </div>
                </accordion-heading>
                <!-- //Task Head -->

                <div class="col-md-12">

                    <div class="row" class="form-horizontal" style="float:left; margin:0px auto; width:100%;">

                        <div class="col-xs-6 form-group form_basic">
                            <label class="form_label">담당자</label>
                            <div class="form_valueText">{{ task.REG_NM }}</div>
                        </div>
                        <div class="col-xs-6 form-group form_basic">
                            <label class="form_label">생성일</label>
                            <div class="form_valueText">{{ task.REG_DT }}</div>
                        </div>

                        <div class="col-xs-6 form-group form_basic">
                            <label class="form_label">카테고리</label>
                            <!--<pre>{{item.CATEGORY|json}}</pre>-->
                            <div class="balls_group">
                                <div class="bnt_ball_group" ng-repeat="category in task.CATEGORY">
                                    <button type="button" class="btn btn-default cate_ball_normal">
                                        {{ category.CATEGORY_NM }}
                                    </button>
                                </div>
                            </div>

                        </div>
                        <div class="col-xs-6 form-group form_basic">
                            <label class="form_label">태그</label>
                            <div class="balls_group">
                                <div class="btn-group bnt_ball_group" ng-repeat="tag in task.TAG | split:','">
                                    <button type="button" class="btn btn-default tag_ball_normal">
                                        {{ tag }}
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-12 form-group form_basic">
                            <label class="form_label">설명</label>
                            <div class="form_valueText">{{ task.NOTE }}</div>
                        </div>

                        <div class="raw" style="float:left; width:100%; padding-top:10px; border-top:1px solid #DEDEDE;">
                            <div class="col-xs-6 form-group form_basic">
                                <button type="button" class="btn btn-info btn-xs start" ng-click="click_showGetHistory(task.NO);">
                                    <i class="glyphicon glyphicon-list-alt"></i>
                                    <span>History</span>
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

            </accordion-group>
        </accordion>

        <div ng-model="item" class="col-xs-12 row" style="margin:0px auto;" ng-init="scope = { isDisabled: false }">
            <form role="form" name="editForm" class="form-horizontal form_basic_100">
                <!--<div class= "form-group form_basic_group">-->
                    <!--<H5 style="line-height:8px; margin:0;">-->
                        <!--<span class="glyphicon glyphicon-pencil" style="color:#2486ED;"></span> <span class="label label-default">편집기</span>를 이용하여 작성합니다.-->
                    <!--</H5>-->
                <!--</div>-->

                <div class= "form-group form_basic_group">
                    <H5 style="line-height:8px; margin:0;">
                        <span class="glyphicon glyphicon-pencil" style="color:#2486ED;"></span> <span class="label label-default"></span>요약
                    </H5>
                </div>

                <div class= "form-group form_basic_group" style="padding-bottom:20px;">
                    <div class= "col-xs-12">
                        <textarea ng-model="item.SUMMARY" class= "form-control" placeholder= "내용 요약.."/>
                    </div>
                </div>

                <div class= "form-group form_basic_group" style="float:left;">

                    <div class="editor_template_cell" style="float:left; width:100%; margin-top:0px; border:1px solid #DEDEDE; border-bottom:none;" ng-show="isTemplet">
                        <div style="width:100%; background:#464646; color:#fff; line-height: 42px; padding-left: 15px;">
                            Template
                            <div style="float:right; margin:8px 15px 0 15px;">
                                <select ng-model="search.YEAR" ng-options="" class="form-control" placeholder="템플릿 유형" style="margin:0; padding:2px; font-size:0.46em; height:25px;">
                                    <option name="template_type" value="">전체 템플릿 보기</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-horizontal" style="float:left; padding:10px;" disabled="{{scope.isDisabled}}">
                            <!-- span ng-click="click_selectTemplet('2E')">2단 사진 세로 구성</span -->
                            <!-- div class="template_thumb" style="background-image:URL() no-repeat;" ng-click="click_selectTemplet('2E')">2단 사진 세로</div -->
                            <div class="template_thumb" style="background-image: URL('/imgs/template_temp.png');" ng-click="click_selectTemplet('basic_template')">기본 레이아웃 (테스트용)</div>
                            <div class="template_thumb" style="background-image: URL('/imgs/template_img00.png');" ng-click="click_selectTemplet('handler_template')">기본 핸들러</div>

                            <div class="template_thumb" style="background-image: URL('/imgs/template_img01.png');" ng-click="click_selectTemplet('plantitle_template')">상단꼭지</div>
                            <div class="template_thumb" style="background-image: URL('/imgs/template_img02.png');" ng-click="click_selectTemplet('headline_template')">일반 제목</div>
                            <div class="template_thumb" style="background-image: URL('/imgs/template_img03.png');" ng-click="click_selectTemplet('byline_template')">바이라인</div>
                            <div class="template_thumb" style="background-image: URL('/imgs/template_img04.png');" ng-click="click_selectTemplet('preface_basic_template')">대표이미지+전문(세로)</div>

                            <div class="template_thumb" style="background-image: URL('/imgs/template_img05.png')" ng-click="click_selectTemplet('sectionmain_template')">중제(일반)</div>
                            <div class="template_thumb" style="background-image: URL('/imgs/template_img06.png')" ng-click="click_selectTemplet('sectionsub_template')">소제(일반)</div>

                            <div class="template_thumb" style="background-image: URL('/imgs/template_img07.png')" ng-click="click_selectTemplet('bodyscript_template')">일반 본문</div>
                            <div class="template_thumb" style="background-image: URL('/imgs/template_img08.png')" ng-click="click_selectTemplet('bodyscript_p2b_template')">이미지(좌)+본문</div>
                            <div class="template_thumb" style="background-image: URL('/imgs/template_img09.png')" ng-click="click_selectTemplet('bodyscript_b2p_template')">본문+이미지(우)</div>

                            <div class="template_thumb" style="background-image: URL('/imgs/template_img10.png')" ng-click="click_selectTemplet('tips_template')">TIP박스</div>
                            <div class="template_thumb" style="background-image: URL('/imgs/template_img11.png')" ng-click="click_selectTemplet('16x9movie_template')">16x9영상</div>

                            <!--<span ng-click="click_selectTemplet('2F')">2단 사진 세로 구성</span>-->
                        </div>
                    </div>

                    <div class="editor_cell">
                        <textarea id="editor1" ng-model="item.BODY" ckeditor="editorOptions" disabled="{{scope.isDisabled}}"></textarea>
                    </div>
                </div>
            </form>

            <div class="col-xs-12 row" style="float:left; margin:0px auto; margin-bottom:60px; ">
                <div class= "col-xs-6 form-group form_basic" style="text-align:left;">
                    <button class="btn btn-success btn-xs fileinput-button" ng-click="click_showContentList();" >
                        <i class="glyphicon glyphicon-upload"></i>
                        <span>{{ isModal ? '닫기' : '목록' }}</span>
                    </button>
                    <button type="button" class="btn btn-warning btn-xs start" ng-click="click_commitContent();" ng-show="isCommit && !(task.PHASE == '11' || task.PHASE == '21')">
                        <i class="glyphicon glyphicon-check"></i>
                        <span>등록&승인요청</span>
                    </button>
                    <button type="button" class="btn btn-danger btn-xs start" ng-click="click_returnContent();" ng-show="isApproval && !(task.PHASE == '12' || task.PHASE == '13' || task.PHASE == '22')">
                        <i class="glyphicon glyphicon-ban-circle"></i>
                        <span>반려</span>
                    </button>
                    <button type="button" class="btn btn-success btn-xs start" ng-click="click_approveContent();" ng-show="isApproval && !(task.PHASE == '12' || task.PHASE == '13' || task.PHASE == '22')">
                        <i class="glyphicon glyphicon-ok-circle"></i>
                        <span>승인</span>
                    </button>
                </div>

                <!-- 하단 버튼 -->
                <div class= "col-xs-6 form-group form_basic" style="text-align:right;">
                    <button type="button" class="btn btn-info btn-xs fileinput-button" ng-click="click_showPreview();" >
                        <i class="glyphicon glyphicon-zoom-in"></i>
                        <span>미리보기</span>
                    </button>

                    <button type="button" class="btn btn-primary btn-xs start" ng-click="click_saveContent();" ng-disabled="editForm.$invalid">
                        <i class="glyphicon glyphicon-plus"></i>
                        <span>저장</span>
                    </button>
                </div>
            </div>

            <div ng-show="task.APPROVAL != '' && (task.PHASE == '12' || task.PHASE == '13' || tash.PHASE == '22')" class= "form-group form_basic_group">
                <H5 style="line-height:8px; margin:0;">
                    <span class="glyphicon glyphicon-pencil" style="color:#2486ED;"></span> 검수 설명
                </H5>

                <div style="margin-top:20px; border:1px solid #DEDEDE; width:100%; float:left;">
                    {{ task.APPROVAL[0].NOTE }}
                </div>
            </div>

            <div class= "form-group form_basic_group" style="float:left;">
                <H5 style="line-height:8px; margin:0;">
                    <span class="glyphicon glyphicon-floppy-disk" style="color:#2486ED;"></span> 파일첨부
                </H5>
                <div ng-include=" '/partials/cms/com/file-list.html' " style="margin-top:20px; width:100%; float:left;"></div>
            </div>
        </div>
    </div>
    <!-- ////Contents Include -->
    </div>

    <div class="modal-footer" style="background-color:#FAFAFA; float:none; text-align:center;" ng-show="isModal">
        <!--<button class="btn btn-default btn-sm" style="margin:0px auto;" ng-click="click_ok()">확인</button>-->
    </div>
</div>


<script type="text/ng-template" id="content_approval_modal.html">
    <div class="modal-header">
        <h3 class="modal-title">{{title}}</h3>
    </div>
    <div class="modal-body">
        <div ng-model="approval" lass="row" class="form-horizontal">
            <div class= "form-group">
                <label class= "col-md-2">메모</label>
                <div class="col-md-9">
                    <textarea ng-model="approval.NOTE" class= "form-control" placeholder= "간략한 설명.."/>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" ng-click="click_ok()">확인</button>
        <button class="btn btn-warning" ng-click="click_cancel()">취소</button>
    </div>
</script>

<script type="text/ng-template" id="preview_modal.html">
    <!DOCTYPE html>

    <html lang="en" ng-controller="CommonController">
    <head>
        <meta charset="utf-8">
        <title>앙쥬 : 시즌2</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">

        <link rel="stylesheet" type="text/css" href="/css/normalize.css" >
        <link rel="stylesheet" type="text/css" href="/css/article_preview.css" />

        <link rel="stylesheet" type="text/css" href="/lib/jquery/css/base/jquery-ui-1.10.2.min.css" />
        <link rel="stylesheet" type="text/css" href="/lib/plupload/jquery.ui.plupload/css/jquery.ui.plupload.css" />


    <!--[if lt IE 9]>
        <script src="lib/html5shiv/html5shiv.js"></script>
<script src="lib/respond/respond.min.js"></script>
<![endif]-->
</head>

<body>
    <div id="articlewrap" class="articlewrap">

        <div class="modal-header article_windowtitle">
            Preview | Web Browser for PC
            <a ng-click="click_ok()" style="float:right; cursor:pointer;">Close</a>
        </div>

        <div class="modal-body">

            <!--<div ng-bind-html="content"></div>-->
            <div ng-bind-html="renderHtml(item.BODY)"></div>

        </div>

        <div class="modal-footer" style="background-color:#FAFAFA; float:none; text-align:center;">
            <button class="btn btn-default btn-sm" style="margin:0px auto;" ng-click="click_ok()">확인</button>
        </div>

    </div>

</body>
</html>

</script>

