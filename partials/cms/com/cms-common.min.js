define(["controller/controllers"],function(q){q.controller("cms-common",["$timeout","$scope","$rootScope","$stateParams","$location","$q","dataService","dialogs","login",function(q,c,d,r,h,k,l,p,s){c.path=h.path();c.formatFileSize=function(a){return 1E9<=a?(a/1E9).toFixed(2)+" GB":1E6<=a?(a/1E6).toFixed(2)+" MB":(a/1E3).toFixed(2)+" KB"};c.login=function(a,b){var e=k.defer();l.login(a,b,function(a,b){200!=b?(console.log("\ub85c\uadf8\uc778\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),e.reject("\ub85c\uadf8\uc778\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):
    1==a.err?(console.log(a.msg),e.reject(a.msg)):angular.isObject(a)?e.resolve(a):(console.log("\uc544\uc774\ub514\ub098 \ud328\uc2a4\uc6cc\ub4dc\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."),e.reject("\uc544\uc774\ub514\ub098 \ud328\uc2a4\uc6cc\ub4dc\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."))});return e.promise};c.logout=function(a){var b=k.defer();l.logout(a,function(a,c){200!=c?(console.log("\ub85c\uadf8\uc544\uc6c3\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),b.reject("\ub85c\uadf8\uc544\uc6c3\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):
    1==a.err?(console.log(a.msg),b.reject(a.msg)):angular.isObject(a)?(d.session=null,d.authenticated=!0,d.uid=null,d.name=null,d.role=null,d.menu_role=null,d.email=null,b.resolve(a)):(console.log("\ub85c\uadf8\uc544\uc6c3\uc5d0 \ud328\uc2a4\uc6cc\ub4dc\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."),b.reject("\ub85c\uadf8\uc544\uc6c3\uc5d0 \ud328\uc2a4\uc6cc\ub4dc\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."))});return b.promise};c.getSession=function(){var a=k.defer();l.getSession(function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         e){200!=e?(h.path("/signin"),console.log("\uc870\ud68c\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),a.reject("\uc870\ud68c\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):1==b.err?(h.path("/signin"),console.log(b.msg),a.reject(b.msg)):angular.isObject(b)?a.resolve(b):(h.path("/signin"),console.log("\uc870\ud68c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),a.reject("\uc870\ud68c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."))});return a.promise};c.sessionCheck=function(a){if(void 0==
    a.USER_ID)throw h.path("/signin"),new String("\uc138\uc158\uc774 \ub9cc\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.");if(""==a.USER_ID)throw h.path("/signin"),new String("\ub85c\uadf8\uc778 \ud6c4 \uc0ac\uc6a9\uac00\ub2a5\ud569\ub2c8\ub2e4.");d.session=a;d.authenticated=!0;d.uid=a.USER_ID;d.name=a.USER_NM;d.role=a.ROLE_ID;d.menu_role=a.MENU_ROLE;d.email=a.EMAIL};c.permissionCheck=function(a,b){var e=h.path();if(void 0==d.session||null==d.session){if(b)throw new String("\ub85c\uadf8\uc778 \ud6c4 \uc0ac\uc6a9\uac00\ub2a5\ud569\ub2c8\ub2e4.");
    p.error("\uc624\ub958","\ub85c\uadf8\uc778 \ud6c4 \uc0ac\uc6a9\uac00\ub2a5\ud569\ub2c8\ub2e4.",{size:"md"});h.path("/signin");return!1}a&&(e=a);var e=e.split("/"),c=e[1],f="";1<e.length&&(f=e[2]);"content"==c&&(c=e[2],f=e[3]);for(var g in d.session.MENU_ROLE){var m=!1,n=d.session.MENU_ROLE[g];if("signup"==c||"signin"==c)m=!0;if(n.MENU_ID==c){if(3>e.length&&"0"==n.MENU_FL)m=!0;else switch(f){case "main":"0"==n.MENU_FL&&(m=!0);break;case "list":"0"==n.LIST_FL&&(m=!0);break;case "view":"0"==n.VIEW_FL&&
(m=!0);break;case "edit":"0"==n.EDIT_FL&&(m=!0)}if(!m){if(b)throw history.back(),new String("\uc811\uadfc\ud560 \uc218 \uc5c6\ub294 \uba54\ub274 \uc785\ub2c8\ub2e4.");p.error("\uc624\ub958","\uc811\uadfc\ud560 \uc218 \uc5c6\ub294 \uba54\ub274 \uc785\ub2c8\ub2e4.",{size:"md"});return!1}}}return!0};c.reportProblems=function(a){p.error("\uc624\ub958",a+"",{size:"md"})};c.getList=function(a,b,e,d,f){var g=k.defer();f&&(c.isLoading=!0);l.db(a).find(b,e,d,function(a,b){200!=b?(console.log("\uc870\ud68c\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),
    g.reject("\uc870\ud68c\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):1==a.err?(console.log(a.msg),g.reject(a.msg)):angular.isObject(a)?g.resolve(a):(console.log("\uc870\ud68c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),g.reject("\uc870\ud68c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."));f&&(c.isLoading=!1)});return g.promise};c.getItem=function(a,b,e,d,f){var g=k.defer();f&&(c.isLoading=!0);l.db(a).findOne(b,e,d,function(a,b){200!=b?(console.log("\uc870\ud68c\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),
    g.reject("\uc870\ud68c\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):1==a.err?(console.log(a.msg),g.reject(a.msg)):angular.isObject(a)?g.resolve(a):(console.log("\uc870\ud68c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),g.reject("\uc870\ud68c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."));f&&(c.isLoading=!1)});return g.promise};c.insertItem=function(a,b,e,d){var f=k.defer();d&&(c.isLoading=!0);l.db(a).insert(b,e,function(a,b){200!=b?(console.log("\ub4f1\ub85d\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),
    f.reject("\ub4f1\ub85d\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):1==a.err?(console.log(a.msg),f.reject(a.msg)):f.resolve();d&&(c.isLoading=!1)});return f.promise};c.updateItem=function(a,b,e,d,f){var g=k.defer();f&&(c.isLoading=!0);l.db(a).update(b,e,d,function(a,b){200!=b?(console.log("\uc218\uc815\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),g.reject("\uc218\uc815\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):1==a.err?(console.log(a.msg),g.reject(a.msg)):g.resolve();f&&(c.isLoading=!1)});
    return g.promise};c.updateStatus=function(a,b,e,d,f){var g=k.defer();f&&(c.isLoading=!0);l.updateStatus(a,b,e,d,function(a,b){200!=b?(console.log("\uc218\uc815\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),g.reject("\uc218\uc815\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):1==a.err?(console.log(a.msg),g.reject(a.msg)):g.resolve();f&&(c.isLoading=!1)});return g.promise};c.deleteItem=function(a,b,d,h){var f=k.defer();h&&(c.isLoading=!0);l.db(a).remove(b,d,function(a,b){200!=b?(console.log("\uc0ad\uc81c\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4."),
    f.reject("\uc0ad\uc81c\uc5d0 \uc2e4\ud328 \ud588\uc2b5\ub2c8\ub2e4.")):1==a.err?(console.log(a.msg),f.reject(a.msg)):f.resolve();h&&(c.isLoading=!1)});return f.promise}}])});