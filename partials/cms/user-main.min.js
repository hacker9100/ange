define(["controller/controllers"],function(g){g.controller("user-main",["$scope","$stateParams","$location","$filter","dialogs","ngTableParams",function(a,g,l,m,b,k){var f=!1;a.key="";a.item={};a.search={SYSTEM_GB:"CMS"};a.init=function(){a.getList("com/permission","list",{},{SYSTEM_GB:"CMS"},!1).then(function(c){a.roles=c;a.user_roles=c;a.item.ROLE=c[0]})["catch"](function(a){console.log(a)})};a.click_deleteCmsUser=function(c,h){var e=a.tableParams.data[c].data[h];b.confirm("\uc54c\ub9bc","\uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c.",
    {size:"md"}).result.then(function(d){a.deleteItem("com/user","item",e.USER_ID,!0).then(function(){b.notify("\uc54c\ub9bc","\uc815\uc0c1\uc801\uc73c\ub85c \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",{size:"md"});a.tableParams.data[c].data.splice(h,1)})["catch"](function(a){b.error("\uc624\ub958",a+"",{size:"md"})})},function(a){})};a.click_searchCmsUser=function(){a.tableParams.reload()};a.getCmsUserList=function(){a.tableParams=new k({page:1,count:1E3,sorting:{USER_NM:"asc"}},{groupBy:"ROLE_NM",
    counts:[],total:0,getData:function(c,b){var e=Object.keys(b.sorting())[0];a.search.SORT=e;a.search.ORDER=b.sorting()[e];a.getList("com/user","list",{},a.search,!0).then(function(d){var e=d[0].TOTAL_COUNT;a.TOTAL_COUNT=e;b.total(e);c.resolve(d)})["catch"](function(a){c.resolve([])})}})};a.click_saveCmsUser=function(){a.item.SYSTEM_GB="CMS";if(""==a.key){if(!f){b.notify("\uc54c\ub9bc","\uc544\uc774\ub514 \ud655\uc778\uc744 \ud574\uc8fc\uc138\uc694.",{size:"md"});return}a.insertItem("com/user","item",
    a.item,!1).then(function(){b.notify("\uc54c\ub9bc","\uc815\uc0c1\uc801\uc73c\ub85c \ub4f1\ub85d\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",{size:"md"});a.tableParams.reload()})["catch"](function(a){b.error("\uc624\ub958",a+"",{size:"md"})})}else a.updateItem("com/user","item",a.key,a.item,!1).then(function(){b.notify("\uc54c\ub9bc","\uc815\uc0c1\uc801\uc73c\ub85c \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",{size:"md"});a.tableParams.reload()})["catch"](function(a){b.error("\uc624\ub958",a+"",{size:"md"})});
    a.click_cancel()};a.click_getCmsUser=function(c){a.key=c;""!=a.key&&a.getItem("com/user","item",a.key,{SYSTEM_GB:"CMS"},!1).then(function(c){for(var b=0,d=0;d<a.user_roles.length;d++)JSON.stringify(c.ROLE)==JSON.stringify(a.user_roles[d])&&(b=d);f=!0;a.item=c;a.item.ROLE=a.user_roles[b];a.click_focus()})["catch"](function(a){b.error("\uc624\ub958",a+"",{size:"md"})})};a.click_updateStatus=function(c){c.USER_ST="N"==c.USER_ST?"F":"N";a.updateItem("com/user","item",c.USER_ID,c,!1).then(function(){b.notify("\uc54c\ub9bc",
    "\uc0ac\uc6a9\uc790 \uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",{size:"md"})})["catch"](function(c){b.error("\uc624\ub958",c+"",{size:"md"});a.tableParams.reload()})};a.click_focus=function(){$("html,body").animate({scrollTop:$("#item").offset().top},100);$("#item_id").focus()};a.click_cancel=function(){f=!1;a.key="";a.item={};a.item.ROLE=a.user_roles[0]};a.click_checkUserId=function(){a.getItem("com/user","check",a.item.USER_ID,{SYSTEM_GB:"CMS"},!1).then(function(a){1>a.COUNT?
    (f=!0,b.notify("\uc54c\ub9bc","\uc0ac\uc6a9 \uac00\ub2a5\ud55c \uc544\uc774\ub514\uc785\ub2c8\ub2e4.",{size:"md"})):b.notify("\uc54c\ub9bc","\uc774\ubbf8 \uc874\uc7ac\ud558\ub294 \uc544\uc774\ub514\uc785\ub2c8\ub2e4.",{size:"md"})})["catch"](function(a){b.error("\uc624\ub958",a+"",{size:"md"})})};a.$watch("item.USER_ID",function(a){f=!1});a.getSession().then(a.sessionCheck).then(a.permissionCheck).then(a.init).then(a.getCmsUserList)["catch"](a.reportProblems)}])});