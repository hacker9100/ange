define(["controller/controllers"],function(l){l.controller("project-edit",["$scope","$stateParams","$location","dialogs","UPLOAD",function(a,d,f,g,e){a.options={url:e.UPLOAD_INDEX,autoUpload:!0,dropZone:angular.element("#dropzone")};a.$watch("newFile",function(c){"undefined"!==typeof c&&(a.file=c[0])});a.item={};a.series=[];var h=[],k=(new Date).getFullYear();a.init=function(c){c=a.getList("cms/series","list",{},{},!1).then(function(c){a.series=c;if(0==d.id){c=[];for(var b in a.series){var e=a.series[b];
    e.SERIES_GB==a.TYPE&&c.push(e)}a.arr_series=c;a.item.SERIES=c[0]}})["catch"](function(a){throw"\uc2dc\ub9ac\uc988:"+a;});for(var b=2010;b<k+5;b++)h.push(b+"");a.years=h;a.item.YEAR=k+"";return c};a.$watch("TYPE",function(c){var b=[];if(void 0!=c){for(var e in a.series){var d=a.series[e];d.SERIES_GB==c&&b.push(d)}a.arr_series=b;a.item.SERIES=b[0]}});a.click_showProjectList=function(){f.url("/project/list")};a.getProject=function(){if(0!=d.id)return a.getItem("cms/project","item",d.id,{},!1).then(function(c){a.item=
    c;a.TYPE=c.SERIES.SERIES_GB;angular.forEach(a.series,function(b,d){JSON.stringify(b)==JSON.stringify(c.SERIES)&&(a.item.SERIES=a.series[d])});var b=c.FILE,d;for(d in b)a.file={name:b[0].FILE_NM,size:b[0].FILE_SIZE,url:e.BASE_URL+b[0].PATH+b[0].FILE_ID,thumbnailUrl:e.BASE_URL+b[0].PATH+"thumbnail/"+b[0].FILE_ID,mediumUrl:e.BASE_URL+b[0].PATH+"medium/"+b[0].FILE_ID,deleteUrl:"http://localhost/serverscript/upload/?file="+b[0].FILE_NM,deleteType:"DELETE"}})["catch"](function(a){g.error("\uc624\ub958",
    a+"",{size:"md"})});a.TYPE=1};a.click_saveProject=function(){a.item.FILE=a.file;a.item.FILE.$destroy="";0==d.id?a.insertItem("cms/project","item",a.item,!1).then(function(){f.url("/project/list")})["catch"](function(a){g.error("\uc624\ub958",a+"",{size:"md"})}):a.updateItem("cms/project","item",d.id,a.item,!1).then(function(){f.url("/project/list")})["catch"](function(a){g.error("\uc624\ub958",a+"",{size:"md"})})};a.getSession().then(a.sessionCheck).then(a.permissionCheck).then(a.init).then(a.getProject)["catch"](a.reportProblems)}])});