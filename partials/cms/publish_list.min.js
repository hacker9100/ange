define(["controller/controllers"],function(controllers){controllers.controller("publish_list",["$scope","$rootScope","$stateParams","$location","dialogs","ngTableParams","COMMON",function($scope,$rootScope,$stateParams,$location,dialogs,ngTableParams,COMMON){$scope.search={STATUS:"2"};var year=[];var now=new Date;var nowYear=now.getFullYear();$scope.init=function(){for(var i=2010;i<nowYear+5;i++)year.push(i+"");var condition=[{name:"\ub4f1\ub85d\uc790",value:"REG_NM"},{name:"\uc81c\ubaa9+\ub0b4\uc6a9",value:"SUBJECT"}];$scope.years=year;$scope.conditions=condition;$scope.search.CONDITION=condition[0]};$scope.click_showViewProject=function(key){$location.url("/project/view/"+key)};$scope.click_publishProject=function(idx){var project=$scope.tableParams.data[idx];$location.path("/publish/edit/"+project.NO)};$scope.click_searchProject=function(){$scope.tableParams.reload()};$scope.getProjectList=function(){$scope.tableParams=new ngTableParams({page:1,count:$scope.PAGE_SIZE,sorting:{REG_DT:"desc"}},{counts:[],total:0,getData:function($defer,params){var key=Object.keys(params.sorting())[0];$scope.search["SORT"]=key;$scope.search["ORDER"]=params.sorting()[key];$scope.getList("cms/project","list",{NO:params.page()-1,SIZE:$scope.PAGE_SIZE},$scope.search,true).then(function(data){params.total(data[0].TOTAL_COUNT);$defer.resolve(data)})["catch"](function(error){$defer.resolve([])})}})};$scope.$watch("selectItems * selectCount < itemsPerPage * currentPage",function(){$scope.selectCount=$scope.selectCount+1});$scope.getSession().then($scope.sessionCheck).then($scope.permissionCheck)["catch"]($scope.reportProblems);$scope.init();$scope.getProjectList()}])});