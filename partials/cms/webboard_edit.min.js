define(["controller/controllers"],function(controllers){controllers.controller("webboard_edit",["$scope","$stateParams","$location","dialogs","UPLOAD",function($scope,$stateParams,$location,dialogs,UPLOAD){$scope.options={url:UPLOAD.UPLOAD_INDEX,autoUpload:true,dropZone:angular.element("#dropzone")};$scope.addEditor=true;$scope.queue=[];$scope.item={};$scope.init=function(session){};$scope.$on("ckeditor.ready",function(event){$scope.isReady=true});$scope.ckeditor="<p>Hello</p>";$scope.click_showCmsBoardList=function(){$location.url("/webboard/list")};$scope.getCmsBoard=function(){if($stateParams.id!=0)$scope.getItem("com/webboard","item",$stateParams.id,{},false).then(function(data){$scope.item=data;$scope.item.NOTICE_FL=="Y"?$scope.item.NOTICE_FL=true:$scope.item.NOTICE_FL=false;var files=data.FILES;for(var i in files)$scope.queue.push({"name":files[i].FILE_NM,"size":files[i].FILE_SIZE,"url":UPLOAD.BASE_URL+files[i].PATH+files[i].FILE_ID,"thumbnailUrl":UPLOAD.BASE_URL+files[i].PATH+"thumbnail/"+files[i].FILE_ID,"mediumUrl":UPLOAD.BASE_URL+files[i].PATH+"medium/"+files[i].FILE_ID,"deleteUrl":"http://localhost/serverscript/upload/?file="+files[i].FILE_NM,"deleteType":"DELETE"})})["catch"](function(error){dialogs.error("\uc624\ub958",error+"",{size:"md"})})};$scope.click_saveCmsBoard=function(){$scope.item.SYSTEM_GB="CMS";$scope.item.FILES=$scope.queue;for(var i in $scope.item.FILES){$scope.item.FILES[i].$destroy="";$scope.item.FILES[i].$editor=""}if($stateParams.id==0)$scope.insertItem("com/webboard","item",$scope.item,false).then(function(){$location.url("/webboard/list")})["catch"](function(error){dialogs.error("\uc624\ub958",error+"",{size:"md"})});else $scope.updateItem("com/webboard","item",$stateParams.id,$scope.item,false).then(function(){$location.url("/webboard/list")})["catch"](function(error){dialogs.error("\uc624\ub958",error+"",{size:"md"})})};$scope.getSession().then($scope.sessionCheck).then($scope.init).then($scope.getCmsBoard)["catch"]($scope.reportProblems)}])});