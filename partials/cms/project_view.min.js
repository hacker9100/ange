define(["controller/controllers"],function(controllers){controllers.controller("project_view",["$scope","$rootScope","$stateParams","$location","$q","dialogs","UPLOAD",function($scope,$rootScope,$stateParams,$location,$q,dialogs,UPLOAD){$scope.item={};$scope.init=function(session){};$scope.click_showProjectEdit=function(item){if(!($rootScope.role=="CMS_ADMIN"||$rootScope.role=="MANAGER")&&$rootScope.uid!=item.REG_UID||item.PROJECT_ST=="3"){dialogs.notify("\uc54c\ub9bc","\uc218\uc815 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",{size:"md"});return}$location.url("/project/edit/"+item.NO)};$scope.click_showProjectList=function(){history.back()};$scope.getProject=function(){if($stateParams.id!=0)$scope.getItem("cms/project","item",$stateParams.id,{},false).then(function(data){$scope.item=data;var file=data.FILE;for(var i in file)$scope.file={"name":file.FILE_NM,"size":file[0].FILE_SIZE,"url":UPLOAD.BASE_URL+file[0].PATH+file[0].FILE_ID,"thumbnailUrl":UPLOAD.BASE_URL+file[0].PATH+"thumbnail/"+file[0].FILE_ID,"mediumUrl":UPLOAD.BASE_URL+file[0].PATH+"medium/"+file[0].FILE_ID,"deleteUrl":"http://localhost/serverscript/upload/?file="+file[0].FILE_NM,"deleteType":"DELETE"}})["catch"](function(error){console.log(error)})};$scope.getTaskList=function(){$scope.getList("cms/task","list",{},{PROJECT:{NO:$stateParams.id}},false).then(function(data){$scope.TOTAL_COUNT=data[0].TOTAL_COUNT;$scope.list=data;console.log(data)})["catch"](function(error){$scope.TOTAL_COUNT=0;$scope.list=[]})};$scope.getSession().then($scope.sessionCheck).then($scope.permissionCheck).then($scope.init).then($scope.getProject).then($scope.getTaskList)["catch"]($scope.reportProblems)}])});